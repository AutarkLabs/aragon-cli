{"version":3,"sources":["../../../src/lib/start/fetch-client.js"],"names":["fetchClient","ctx","task","clientVersion","clientFetch","clientAvailable","CLIENT_PATH","os","homedir","clientPath","path","resolve","skip","files","require","BUILD_PATH","join"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;;;;;;;SAEsBA,W;;;;;;;0BAAf,iBAA2BC,GAA3B,EAAgCC,IAAhC,EAAsCC,aAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AACLF,YAAAA,GAAG,CAACG,WAAJ,GAAkB,IAAlB;AACAH,YAAAA,GAAG,CAACI,eAAJ,GAAsB,IAAtB;AAEMC,YAAAA,WAJD,aAIkBC,eAAGC,OAAH,EAJlB,6BAIiDL,aAJjD;AAKLF,YAAAA,GAAG,CAACQ,UAAJ,GAAiBH,WAAjB,CALK,CAOL;;AAPK,iBAQD,yBAAWI,iBAAKC,OAAL,CAAaL,WAAb,CAAX,CARC;AAAA;AAAA;AAAA;;AASHJ,YAAAA,IAAI,CAACU,IAAL,CAAU,wBAAV;AATG;;AAAA;AAaL;AACMC,YAAAA,KAdD,GAcSH,iBAAKC,OAAL,CACZG,OAAO,CAACH,OAAR,CAAgB,gBAAhB,CADY,EAEZ,eAFY,EAGZ,gBAHY,CAdT,EAoBL;;AACMI,YAAAA,UArBD,GAqBcL,iBAAKM,IAAL,CAAUV,WAAV,EAAuB,OAAvB,CArBd;AAsBL,wCAAcS,UAAd,EAtBK,CAwBL;;AAxBK;AAAA,mBAyBC,mBAAKF,KAAL,EAAYE,UAAZ,CAzBD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import path from 'path'\nimport { copy, existsSync, ensureDirSync } from 'fs-extra'\nimport os from 'os'\n\nexport async function fetchClient(ctx, task, clientVersion) {\n  ctx.clientFetch = true\n  ctx.clientAvailable = true\n\n  const CLIENT_PATH = `${os.homedir()}/.aragon/client-${clientVersion}`\n  ctx.clientPath = CLIENT_PATH\n\n  // Make sure we haven't already downloaded the client\n  if (existsSync(path.resolve(CLIENT_PATH))) {\n    task.skip('Client already fetched')\n    return\n  }\n\n  // Get prebuild client from aragen\n  const files = path.resolve(\n    require.resolve('@aragon/aragen'),\n    '../ipfs-cache',\n    '@aragon/aragon'\n  )\n\n  // Ensure folder exists\n  const BUILD_PATH = path.join(CLIENT_PATH, 'build')\n  ensureDirSync(BUILD_PATH)\n\n  // Copy files\n  await copy(files, BUILD_PATH)\n}\n"],"file":"fetch-client.js"}